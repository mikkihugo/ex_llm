# CI Test Exclusion Configuration
# ================================
# Tests that are currently excluded from CI due to incomplete NATSâ†’pgmq migration.
# These tests require infrastructure dependencies that are being refactored.
#
# Format: Path to test file (relative to singularity/ root)
# Reason: Why it's excluded
# Status: Migration status
# Priority: Migration priority (high/medium/low)

# HIGH PRIORITY - Template Usage Tracking (affects core template system)
test/singularity/knowledge/template_usage_tracking_test.exs
Reason: NATS event publishing for template usage tracking - needs pgmq integration
Status: Waiting for pgmq event table schema creation
Priority: HIGH
Migration: Replace NATS subscription with pgmq queue reading from template_usage_events table

test/singularity/knowledge/template_service_solid_test.exs
Reason: Template service publishes NATS events on successful render
Status: Waiting for pgmq event publishing
Priority: HIGH
Migration: Replace TemplateService.publish_usage_event() with pgmq insertion

test/singularity/agents/cost_optimized_agent_templates_test.exs
Reason: Template selection and usage tracking via NATS
Status: Waiting for pgmq integration
Priority: HIGH
Migration: Replace NATS subscription monitoring with database event polling

# MEDIUM PRIORITY - Job Event Publishing (affects background jobs)
test/singularity/jobs/train_t5_model_job_test.exs
Reason: Job completion events published to NATS
Status: Waiting for job_events table and pgmq integration
Priority: MEDIUM
Migration: Replace JobEventPublisher.publish() with pgmq insertion to job_events queue

# MEDIUM PRIORITY - Task Execution & Coordination
test/singularity/execution/task_adapter_orchestrator_test.exs
Reason: References NatsAdapter which is being deprecated
Status: Waiting for adapter refactoring
Priority: MEDIUM
Migration: Update adapter discovery to use pgmq-based queueing

test/singularity/execution_coordinator_integration_test.exs
Reason: Full pipeline integration with NatsOrchestrator
Status: Waiting for ExecutionCoordinator pgmq refactoring
Priority: MEDIUM
Migration: Replace NATS message reception with pgmq polling

test/singularity/runner_test.exs
Reason: Event publishing and NATS connection status tracking
Status: Waiting for Runner.publish_event() refactoring
Priority: MEDIUM
Migration: Replace NATS events with pgmq; check pgmq health instead of NATS

# LOW PRIORITY - Framework Pattern Learning (already works)
test/singularity/architecture_engine/meta_registry/framework_learning_test.exs
Reason: Learns NATS patterns from code (not from NATS events) - safe but has NATS test data
Status: Safe to run - database-driven tests
Priority: LOW
Migration: No urgent need, but can add pgmq pattern learning tests later

# EXCLUDED TEST TAGS
# ==================
# Tests tagged with @tag :nats_required are automatically skipped in CI via ExUnit config

# Reference Implementation (already using pgmq)
# singularity/test/singularity/llm/service_pgmq_integration_test.exs - USE AS PATTERN

# Database-Driven Tests (safe to run)
# singularity/test/singularity/learning/genesis_integration_test.exs - No NATS dependency
