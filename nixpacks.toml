# Nixpacks configuration for fly.io
# Tells fly.io how to build with Nix

[phases.setup]
nixPkgs = ["nixFlakes"]
nixOverlays = []
nixLibs = []

[phases.install]
cmds = [
  "nix --experimental-features 'nix-command flakes' build .#singularity-integrated"
]

[phases.build]
cmds = [
  "cp -rL result/* /app/"
]

[start]
cmd = "/app/bin/start-singularity"
