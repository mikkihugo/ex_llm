{
  "framework_id": "gdpr",
  "name": "GDPR - General Data Protection Regulation",
  "description": "EU General Data Protection Regulation compliance for personal data protection and privacy rights",
  "version": "2.0",
  "applicable_to": ["all"],
  "last_updated": "2025-10-30",

  "personal_data_detection": {
    "data_categories": [
      "basic_identity_data",
      "financial_data",
      "location_data",
      "online_identifiers",
      "health_data",
      "biometric_data",
      "genetic_data",
      "racial_ethnic_data",
      "political_opinions",
      "religious_beliefs",
      "trade_union_membership",
      "sex_life_orientation"
    ],
    "detection_patterns": [
      "Email addresses",
      "Phone numbers",
      "IP addresses",
      "Cookie identifiers",
      "National ID numbers",
      "Passport numbers",
      "Credit card numbers",
      "Bank account numbers",
      "GPS coordinates",
      "Biometric templates"
    ]
  },

  "compliance_controls": [
    {
      "control_id": "Article 5",
      "control_name": "Principles relating to processing",
      "category": "Data Protection Principles",
      "description": "Personal data shall be processed lawfully, fairly and in a transparent manner.",
      "code_requirements": [
        {
          "requirement": "Lawfulness, fairness and transparency",
          "languages": ["all"],
          "bad_patterns": [
            "no_legal_basis_check",
            "hidden_data_processing",
            "unclear_privacy_notice"
          ],
          "good_patterns": [
            "consent_management",
            "legal_basis_documentation",
            "transparent_processing"
          ],
          "severity": "critical"
        },
        {
          "requirement": "Purpose limitation",
          "languages": ["all"],
          "bad_patterns": [
            "undefined_purposes",
            "purpose_creep",
            "secondary_use_without_consent"
          ],
          "good_patterns": [
            "defined_purposes",
            "purpose_enforcement",
            "compatible_processing"
          ],
          "severity": "high"
        },
        {
          "requirement": "Data minimization",
          "languages": ["all"],
          "bad_patterns": [
            "excessive_data_collection",
            "unnecessary_fields",
            "collect_everything_approach"
          ],
          "good_patterns": [
            "minimal_data_collection",
            "need_based_collection",
            "data_relevance_checks"
          ],
          "severity": "high"
        },
        {
          "requirement": "Accuracy",
          "languages": ["all"],
          "bad_patterns": [
            "no_data_validation",
            "no_update_mechanism",
            "stale_data_retention"
          ],
          "good_patterns": [
            "data_accuracy_checks",
            "update_mechanisms",
            "data_quality_monitoring"
          ],
          "severity": "medium"
        },
        {
          "requirement": "Storage limitation",
          "languages": ["all"],
          "bad_patterns": [
            "indefinite_retention",
            "no_deletion_policy",
            "no_retention_limits"
          ],
          "good_patterns": [
            "retention_policies",
            "automated_deletion",
            "periodic_review"
          ],
          "severity": "high"
        }
      ]
    },
    {
      "control_id": "Article 6",
      "control_name": "Lawfulness of processing",
      "category": "Legal Basis",
      "description": "Processing shall be lawful only if and to the extent that at least one legal basis applies.",
      "code_requirements": [
        {
          "requirement": "Legal basis verification",
          "languages": ["all"],
          "bad_patterns": [
            "no_consent_check",
            "forced_consent",
            "bundled_consent"
          ],
          "good_patterns": [
            "explicit_consent",
            "granular_consent",
            "withdraw_consent_option"
          ],
          "severity": "critical"
        }
      ]
    },
    {
      "control_id": "Article 7",
      "control_name": "Conditions for consent",
      "category": "Consent Management",
      "description": "Where processing is based on consent, the controller shall be able to demonstrate that consent was given.",
      "code_requirements": [
        {
          "requirement": "Consent management",
          "languages": ["all"],
          "bad_patterns": [
            "no_consent_records",
            "pre_ticked_boxes",
            "implicit_consent",
            "no_withdrawal_mechanism"
          ],
          "good_patterns": [
            "consent_audit_trail",
            "explicit_opt_in",
            "easy_withdrawal",
            "consent_versioning"
          ],
          "severity": "critical"
        }
      ]
    },
    {
      "control_id": "Article 12",
      "control_name": "Transparent information",
      "category": "Data Subject Rights",
      "description": "The controller shall take appropriate measures to provide information relating to processing in a transparent manner.",
      "code_requirements": [
        {
          "requirement": "Privacy notice implementation",
          "languages": ["all"],
          "bad_patterns": [
            "no_privacy_notice",
            "hidden_privacy_policy",
            "complex_legal_language"
          ],
          "good_patterns": [
            "clear_privacy_notice",
            "layered_privacy_notice",
            "plain_language"
          ],
          "severity": "high"
        }
      ]
    },
    {
      "control_id": "Article 15",
      "control_name": "Right of access",
      "category": "Data Subject Rights",
      "description": "The data subject shall have the right to obtain confirmation as to whether personal data is being processed.",
      "code_requirements": [
        {
          "requirement": "Data access mechanisms",
          "languages": ["all"],
          "bad_patterns": [
            "no_access_mechanism",
            "manual_access_only",
            "incomplete_data_export"
          ],
          "good_patterns": [
            "self_service_access",
            "complete_data_export",
            "automated_sar_response"
          ],
          "severity": "high"
        }
      ]
    },
    {
      "control_id": "Article 16",
      "control_name": "Right to rectification",
      "category": "Data Subject Rights",
      "description": "The data subject shall have the right to obtain rectification of inaccurate personal data.",
      "code_requirements": [
        {
          "requirement": "Data correction mechanisms",
          "languages": ["all"],
          "bad_patterns": [
            "no_update_interface",
            "read_only_profiles",
            "no_correction_workflow"
          ],
          "good_patterns": [
            "self_service_updates",
            "correction_audit_trail",
            "update_notifications"
          ],
          "severity": "medium"
        }
      ]
    },
    {
      "control_id": "Article 17",
      "control_name": "Right to erasure",
      "category": "Data Subject Rights",
      "description": "The data subject shall have the right to obtain erasure of personal data (right to be forgotten).",
      "code_requirements": [
        {
          "requirement": "Data deletion mechanisms",
          "languages": ["all"],
          "bad_patterns": [
            "no_deletion_capability",
            "soft_delete_only",
            "incomplete_deletion",
            "no_cascade_deletion"
          ],
          "good_patterns": [
            "complete_data_erasure",
            "cascade_deletion",
            "deletion_verification",
            "backup_purging"
          ],
          "severity": "critical"
        }
      ]
    },
    {
      "control_id": "Article 18",
      "control_name": "Right to restriction",
      "category": "Data Subject Rights",
      "description": "The data subject shall have the right to obtain restriction of processing.",
      "code_requirements": [
        {
          "requirement": "Processing restriction",
          "languages": ["all"],
          "bad_patterns": [
            "no_processing_flags",
            "no_restriction_capability",
            "all_or_nothing_processing"
          ],
          "good_patterns": [
            "processing_flags",
            "granular_restrictions",
            "restriction_audit_log"
          ],
          "severity": "medium"
        }
      ]
    },
    {
      "control_id": "Article 20",
      "control_name": "Right to data portability",
      "category": "Data Subject Rights",
      "description": "The data subject shall have the right to receive personal data in a structured, commonly used and machine-readable format.",
      "code_requirements": [
        {
          "requirement": "Data portability",
          "languages": ["all"],
          "bad_patterns": [
            "no_export_functionality",
            "proprietary_formats",
            "incomplete_exports"
          ],
          "good_patterns": [
            "json_export",
            "csv_export",
            "api_based_export",
            "complete_data_package"
          ],
          "severity": "high"
        }
      ]
    },
    {
      "control_id": "Article 25",
      "control_name": "Data protection by design and default",
      "category": "Privacy by Design",
      "description": "The controller shall implement appropriate technical and organizational measures designed to implement data-protection principles.",
      "code_requirements": [
        {
          "requirement": "Privacy by design",
          "languages": ["all"],
          "bad_patterns": [
            "privacy_as_afterthought",
            "default_public_settings",
            "opt_out_defaults"
          ],
          "good_patterns": [
            "privacy_first_architecture",
            "secure_defaults",
            "opt_in_design"
          ],
          "severity": "high"
        },
        {
          "requirement": "Data minimization by default",
          "languages": ["all"],
          "bad_patterns": [
            "collect_all_fields",
            "mandatory_optional_fields",
            "excessive_defaults"
          ],
          "good_patterns": [
            "minimal_defaults",
            "progressive_disclosure",
            "optional_fields_truly_optional"
          ],
          "severity": "high"
        }
      ]
    },
    {
      "control_id": "Article 32",
      "control_name": "Security of processing",
      "category": "Security Measures",
      "description": "The controller shall implement appropriate technical and organizational measures to ensure appropriate security.",
      "code_requirements": [
        {
          "requirement": "Pseudonymization and encryption",
          "languages": ["all"],
          "bad_patterns": [
            "plaintext_storage",
            "weak_encryption",
            "no_pseudonymization"
          ],
          "good_patterns": [
            "strong_encryption",
            "data_pseudonymization",
            "tokenization"
          ],
          "severity": "critical"
        },
        {
          "requirement": "Confidentiality and integrity",
          "languages": ["all"],
          "bad_patterns": [
            "no_access_controls",
            "no_integrity_checks",
            "unencrypted_transmission"
          ],
          "good_patterns": [
            "role_based_access",
            "integrity_verification",
            "secure_transmission"
          ],
          "severity": "critical"
        }
      ]
    },
    {
      "control_id": "Article 33",
      "control_name": "Breach notification to authority",
      "category": "Breach Management",
      "description": "In case of a personal data breach, the controller shall notify the supervisory authority within 72 hours.",
      "code_requirements": [
        {
          "requirement": "Breach detection and notification",
          "languages": ["all"],
          "bad_patterns": [
            "no_breach_detection",
            "no_incident_response",
            "delayed_notification"
          ],
          "good_patterns": [
            "automated_breach_detection",
            "incident_response_plan",
            "notification_workflow"
          ],
          "severity": "high"
        }
      ]
    },
    {
      "control_id": "Article 35",
      "control_name": "Data protection impact assessment",
      "category": "Risk Assessment",
      "description": "Where processing is likely to result in high risk, the controller shall carry out a DPIA.",
      "code_requirements": [
        {
          "requirement": "DPIA implementation",
          "languages": ["all"],
          "bad_patterns": [
            "no_risk_assessment",
            "high_risk_processing_unchecked",
            "no_dpia_process"
          ],
          "good_patterns": [
            "dpia_workflow",
            "risk_assessment_framework",
            "mitigation_tracking"
          ],
          "severity": "medium"
        }
      ]
    }
  ],

  "code_checks": [
    {
      "check_name": "Personal Data Detection",
      "check_id": "gdpr_personal_data",
      "description": "Detect unprotected personal data",
      "severity": "critical",
      "framework_controls": ["Article 5", "Article 32"],
      "detection_rules": {
        "languages": ["all"],
        "patterns": [
          "Email regex without encryption",
          "Phone numbers in logs",
          "IP addresses unmasked",
          "National ID patterns",
          "Unencrypted PII storage"
        ]
      }
    },
    {
      "check_name": "Consent Management",
      "check_id": "gdpr_consent",
      "description": "Verify proper consent implementation",
      "severity": "critical",
      "framework_controls": ["Article 6", "Article 7"],
      "detection_rules": {
        "languages": ["all"],
        "patterns": [
          "No consent check",
          "Pre-ticked consent boxes",
          "No withdrawal mechanism",
          "Forced consent patterns"
        ]
      }
    },
    {
      "check_name": "Data Subject Rights",
      "check_id": "gdpr_rights",
      "description": "Verify data subject rights implementation",
      "severity": "high",
      "framework_controls": ["Article 15", "Article 16", "Article 17", "Article 20"],
      "detection_rules": {
        "languages": ["all"],
        "patterns": [
          "No deletion capability",
          "No data export",
          "No update mechanism",
          "Soft delete only"
        ]
      }
    },
    {
      "check_name": "Data Retention",
      "check_id": "gdpr_retention",
      "description": "Verify data retention policies",
      "severity": "high",
      "framework_controls": ["Article 5"],
      "detection_rules": {
        "languages": ["all"],
        "patterns": [
          "No retention policy",
          "Indefinite storage",
          "No automated deletion",
          "No data lifecycle"
        ]
      }
    },
    {
      "check_name": "Encryption Standards",
      "check_id": "gdpr_encryption",
      "description": "Verify encryption implementation",
      "severity": "critical",
      "framework_controls": ["Article 32"],
      "detection_rules": {
        "languages": ["all"],
        "patterns": [
          "Plaintext personal data",
          "Weak encryption algorithms",
          "Unencrypted transmission",
          "No pseudonymization"
        ]
      }
    },
    {
      "check_name": "Privacy by Design",
      "check_id": "gdpr_privacy_design",
      "description": "Verify privacy by design principles",
      "severity": "high",
      "framework_controls": ["Article 25"],
      "detection_rules": {
        "languages": ["all"],
        "patterns": [
          "Default public settings",
          "Opt-out defaults",
          "Excessive data collection",
          "No data minimization"
        ]
      }
    }
  ],

  "remediation_roadmap": {
    "phase_1": {
      "timeline": "30 days",
      "controls": ["Article 6", "Article 7", "Article 32"],
      "tasks": [
        "Implement consent management system",
        "Deploy encryption for personal data",
        "Create privacy notices",
        "Establish legal basis for processing"
      ]
    },
    "phase_2": {
      "timeline": "60 days",
      "controls": ["Article 15", "Article 16", "Article 17", "Article 20"],
      "tasks": [
        "Implement data subject rights portal",
        "Create data deletion mechanisms",
        "Deploy data export functionality",
        "Establish update workflows"
      ]
    },
    "phase_3": {
      "timeline": "90 days",
      "controls": ["Article 5", "Article 25", "Article 33", "Article 35"],
      "tasks": [
        "Implement retention policies",
        "Deploy privacy by design principles",
        "Create breach notification process",
        "Establish DPIA framework"
      ]
    }
  },

  "references": [
    "https://gdpr.eu/",
    "Regulation (EU) 2016/679",
    "EDPB Guidelines",
    "Article 29 Working Party Guidelines",
    "ICO GDPR Guide"
  ]
}