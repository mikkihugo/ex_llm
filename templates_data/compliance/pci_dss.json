{
  "framework_id": "pci_dss",
  "name": "PCI-DSS - Payment Card Industry Data Security Standard",
  "description": "PCI DSS v4.0 compliance for protecting cardholder data and maintaining secure payment systems",
  "version": "4.0",
  "applicable_to": ["payment", "ecommerce", "retail", "all"],
  "last_updated": "2025-10-30",

  "cardholder_data_detection": {
    "sensitive_data_types": [
      "primary_account_number",
      "cardholder_name",
      "expiration_date",
      "service_code",
      "cvv_cvc_cvv2_cvc2",
      "pin_pin_block",
      "magnetic_stripe_data",
      "chip_data"
    ],
    "detection_patterns": [
      "Credit card numbers: \\d{13,19}",
      "CVV/CVC codes: \\d{3,4}",
      "Expiration dates: \\d{2}/\\d{2,4}",
      "Track data in logs",
      "Unencrypted PAN storage",
      "Card data in error messages"
    ]
  },

  "compliance_controls": [
    {
      "control_id": "1.1",
      "control_name": "Network Security Controls",
      "category": "Build and Maintain Secure Networks",
      "description": "Processes and mechanisms for installing and maintaining network security controls.",
      "code_requirements": [
        {
          "requirement": "Network segmentation",
          "languages": ["all"],
          "bad_patterns": [
            "flat_network_architecture",
            "no_dmz_implementation",
            "unrestricted_internal_access"
          ],
          "good_patterns": [
            "network_segmentation",
            "dmz_architecture",
            "microsegmentation"
          ],
          "severity": "high"
        },
        {
          "requirement": "Firewall configuration",
          "languages": ["all"],
          "bad_patterns": [
            "any_any_firewall_rules",
            "default_allow_rules",
            "no_outbound_restrictions"
          ],
          "good_patterns": [
            "least_privilege_rules",
            "default_deny_rules",
            "documented_firewall_rules"
          ],
          "severity": "critical"
        }
      ]
    },
    {
      "control_id": "2.1",
      "control_name": "Default Passwords and Security Parameters",
      "category": "Build and Maintain Secure Networks",
      "description": "Change all vendor-supplied defaults and remove or disable unnecessary default accounts.",
      "code_requirements": [
        {
          "requirement": "No default credentials",
          "languages": ["all"],
          "bad_patterns": [
            "default_admin_password",
            "hardcoded_credentials",
            "vendor_default_settings",
            "admin_admin_credentials"
          ],
          "good_patterns": [
            "forced_password_change",
            "unique_initial_passwords",
            "secure_credential_generation"
          ],
          "severity": "critical"
        }
      ]
    },
    {
      "control_id": "3.1",
      "control_name": "Storage of Account Data",
      "category": "Protect Cardholder Data",
      "description": "Processes and mechanisms for protecting stored account data.",
      "code_requirements": [
        {
          "requirement": "Data retention and disposal",
          "languages": ["all"],
          "bad_patterns": [
            "indefinite_card_storage",
            "no_data_retention_policy",
            "soft_delete_only"
          ],
          "good_patterns": [
            "automated_data_purging",
            "secure_data_deletion",
            "retention_policy_enforcement"
          ],
          "severity": "high"
        },
        {
          "requirement": "Prohibited data storage",
          "languages": ["all"],
          "bad_patterns": [
            "storing_cvv_codes",
            "storing_pin_data",
            "storing_track_data",
            "storing_mag_stripe_data"
          ],
          "good_patterns": [
            "no_sensitive_auth_data",
            "tokenization_implementation",
            "truncation_masking"
          ],
          "severity": "critical"
        }
      ]
    },
    {
      "control_id": "3.3",
      "control_name": "Secure Cryptographic Storage",
      "category": "Protect Cardholder Data",
      "description": "Secure cryptographic key storage for keys used to protect stored account data.",
      "code_requirements": [
        {
          "requirement": "Key management",
          "languages": ["all"],
          "bad_patterns": [
            "hardcoded_encryption_keys",
            "keys_in_source_control",
            "weak_key_generation",
            "no_key_rotation"
          ],
          "good_patterns": [
            "hsm_key_storage",
            "key_management_service",
            "regular_key_rotation",
            "split_knowledge_dual_control"
          ],
          "severity": "critical"
        }
      ]
    },
    {
      "control_id": "3.4",
      "control_name": "Strong Cryptography for PAN Display",
      "category": "Protect Cardholder Data",
      "description": "PAN is rendered unreadable anywhere it is stored using strong cryptography.",
      "code_requirements": [
        {
          "requirement": "PAN masking and truncation",
          "languages": ["all"],
          "bad_patterns": [
            "full_pan_display",
            "unmasked_pan_in_logs",
            "clear_text_pan_storage"
          ],
          "good_patterns": [
            "pan_masking_first12",
            "show_only_last4",
            "field_level_encryption"
          ],
          "severity": "critical"
        }
      ]
    },
    {
      "control_id": "4.1",
      "control_name": "Strong Cryptography During Transmission",
      "category": "Protect Cardholder Data",
      "description": "Use strong cryptography and security protocols to safeguard sensitive cardholder data during transmission.",
      "code_requirements": [
        {
          "requirement": "Encryption in transit",
          "languages": ["all"],
          "bad_patterns": [
            "http_card_transmission",
            "tls_1_0_usage",
            "ssl_v3_usage",
            "unencrypted_api_calls"
          ],
          "good_patterns": [
            "tls_1_2_minimum",
            "tls_1_3_preferred",
            "certificate_validation",
            "perfect_forward_secrecy"
          ],
          "severity": "critical"
        }
      ]
    },
    {
      "control_id": "6.1",
      "control_name": "Security Vulnerabilities",
      "category": "Maintain Vulnerability Management",
      "description": "Processes for identifying security vulnerabilities and protecting system components from vulnerabilities.",
      "code_requirements": [
        {
          "requirement": "Vulnerability management",
          "languages": ["all"],
          "bad_patterns": [
            "no_vulnerability_scanning",
            "unpatched_dependencies",
            "ignored_cve_alerts"
          ],
          "good_patterns": [
            "automated_vulnerability_scanning",
            "dependency_update_process",
            "cve_monitoring"
          ],
          "severity": "high"
        }
      ]
    },
    {
      "control_id": "6.2",
      "control_name": "System Components Protection",
      "category": "Maintain Vulnerability Management",
      "description": "Bespoke and custom software are developed securely.",
      "code_requirements": [
        {
          "requirement": "Secure development practices",
          "languages": ["all"],
          "bad_patterns": [
            "no_code_review",
            "no_security_testing",
            "production_debugging_enabled"
          ],
          "good_patterns": [
            "mandatory_code_review",
            "security_testing_pipeline",
            "secure_coding_standards"
          ],
          "severity": "high"
        },
        {
          "requirement": "Input validation",
          "languages": ["all"],
          "bad_patterns": [
            "no_input_validation",
            "sql_injection_vulnerable",
            "xss_vulnerable",
            "command_injection"
          ],
          "good_patterns": [
            "parameterized_queries",
            "input_sanitization",
            "output_encoding",
            "whitelist_validation"
          ],
          "severity": "critical"
        }
      ]
    },
    {
      "control_id": "7.1",
      "control_name": "Restrict Access by Business Need",
      "category": "Implement Strong Access Control",
      "description": "Processes and mechanisms for restricting access to system components and cardholder data by business need to know.",
      "code_requirements": [
        {
          "requirement": "Least privilege access",
          "languages": ["all"],
          "bad_patterns": [
            "all_users_admin",
            "blanket_data_access",
            "no_role_separation"
          ],
          "good_patterns": [
            "role_based_access",
            "need_to_know_basis",
            "segregation_of_duties"
          ],
          "severity": "critical"
        }
      ]
    },
    {
      "control_id": "8.1",
      "control_name": "User Identification and Authentication",
      "category": "Implement Strong Access Control",
      "description": "Processes and mechanisms for identifying users and authenticating access to system components.",
      "code_requirements": [
        {
          "requirement": "Unique user IDs",
          "languages": ["all"],
          "bad_patterns": [
            "shared_user_accounts",
            "generic_accounts",
            "group_accounts"
          ],
          "good_patterns": [
            "individual_user_ids",
            "unique_authentication",
            "user_accountability"
          ],
          "severity": "critical"
        },
        {
          "requirement": "Strong authentication",
          "languages": ["all"],
          "bad_patterns": [
            "weak_password_policy",
            "no_mfa",
            "password_only_auth"
          ],
          "good_patterns": [
            "complex_password_requirements",
            "multi_factor_authentication",
            "password_history_enforcement"
          ],
          "severity": "high"
        }
      ]
    },
    {
      "control_id": "10.1",
      "control_name": "Logging and Monitoring",
      "category": "Monitor and Test Networks",
      "description": "Processes and mechanisms for logging and monitoring all access to system components and cardholder data.",
      "code_requirements": [
        {
          "requirement": "Audit trail implementation",
          "languages": ["all"],
          "bad_patterns": [
            "no_audit_logging",
            "incomplete_audit_trails",
            "modifiable_logs"
          ],
          "good_patterns": [
            "comprehensive_audit_logging",
            "centralized_log_management",
            "tamper_proof_logs"
          ],
          "severity": "critical"
        },
        {
          "requirement": "Log content requirements",
          "languages": ["all"],
          "bad_patterns": [
            "missing_user_identification",
            "no_timestamp",
            "no_event_type",
            "card_data_in_logs"
          ],
          "good_patterns": [
            "user_id_in_logs",
            "event_type_logging",
            "success_failure_indication",
            "origination_identification"
          ],
          "severity": "high"
        }
      ]
    },
    {
      "control_id": "11.1",
      "control_name": "Security Testing",
      "category": "Monitor and Test Networks",
      "description": "Processes for regularly testing security of systems and networks.",
      "code_requirements": [
        {
          "requirement": "Regular security testing",
          "languages": ["all"],
          "bad_patterns": [
            "no_penetration_testing",
            "no_vulnerability_scanning",
            "untested_security_controls"
          ],
          "good_patterns": [
            "quarterly_vulnerability_scans",
            "annual_penetration_tests",
            "continuous_security_testing"
          ],
          "severity": "high"
        }
      ]
    },
    {
      "control_id": "12.1",
      "control_name": "Information Security Policy",
      "category": "Maintain Security Policy",
      "description": "A formal information security policy is established, published, maintained, and disseminated to all personnel.",
      "code_requirements": [
        {
          "requirement": "Security policy implementation",
          "languages": ["all"],
          "bad_patterns": [
            "no_security_policies",
            "outdated_policies",
            "unenforced_policies"
          ],
          "good_patterns": [
            "documented_security_policies",
            "annual_policy_review",
            "policy_enforcement_mechanisms"
          ],
          "severity": "medium"
        }
      ]
    }
  ],

  "code_checks": [
    {
      "check_name": "Cardholder Data Detection",
      "check_id": "pci_card_data",
      "description": "Detect exposed cardholder data in code",
      "severity": "critical",
      "framework_controls": ["3.1", "3.3", "3.4"],
      "detection_rules": {
        "languages": ["all"],
        "patterns": [
          "Credit card regex: \\d{13,19}",
          "CVV/CVC storage",
          "Track data patterns",
          "Unencrypted PAN",
          "Card data in logs"
        ]
      }
    },
    {
      "check_name": "Encryption Standards",
      "check_id": "pci_encryption",
      "description": "Verify strong cryptography implementation",
      "severity": "critical",
      "framework_controls": ["3.3", "3.4", "4.1"],
      "detection_rules": {
        "languages": ["all"],
        "patterns": [
          "Weak encryption algorithms",
          "TLS < 1.2",
          "Hardcoded encryption keys",
          "HTTP card transmission"
        ]
      }
    },
    {
      "check_name": "Access Control",
      "check_id": "pci_access_control",
      "description": "Verify least privilege and authentication",
      "severity": "critical",
      "framework_controls": ["7.1", "8.1"],
      "detection_rules": {
        "languages": ["all"],
        "patterns": [
          "Missing access controls",
          "Shared accounts",
          "No MFA implementation",
          "Weak password policy"
        ]
      }
    },
    {
      "check_name": "Input Validation",
      "check_id": "pci_input_validation",
      "description": "Verify protection against injection attacks",
      "severity": "critical",
      "framework_controls": ["6.2"],
      "detection_rules": {
        "languages": ["all"],
        "patterns": [
          "SQL injection vulnerabilities",
          "XSS vulnerabilities",
          "Command injection",
          "No input sanitization"
        ]
      }
    },
    {
      "check_name": "Audit Logging",
      "check_id": "pci_audit_logging",
      "description": "Verify comprehensive audit trail",
      "severity": "critical",
      "framework_controls": ["10.1"],
      "detection_rules": {
        "languages": ["all"],
        "patterns": [
          "Missing audit logs",
          "Incomplete log data",
          "Modifiable logs",
          "Card data in logs"
        ]
      }
    },
    {
      "check_name": "Default Credentials",
      "check_id": "pci_default_creds",
      "description": "Detect default or weak credentials",
      "severity": "critical",
      "framework_controls": ["2.1"],
      "detection_rules": {
        "languages": ["all"],
        "patterns": [
          "Default admin passwords",
          "Hardcoded credentials",
          "admin/admin patterns",
          "Vendor default settings"
        ]
      }
    }
  ],

  "remediation_roadmap": {
    "phase_1": {
      "timeline": "30 days",
      "controls": ["3.1", "3.3", "3.4", "4.1"],
      "tasks": [
        "Remove all prohibited data storage (CVV, PIN, track data)",
        "Implement PAN encryption at rest",
        "Deploy TLS 1.2+ for all transmissions",
        "Mask/truncate PAN displays"
      ]
    },
    "phase_2": {
      "timeline": "60 days",
      "controls": ["2.1", "7.1", "8.1", "10.1"],
      "tasks": [
        "Change all default credentials",
        "Implement role-based access control",
        "Deploy multi-factor authentication",
        "Enable comprehensive audit logging"
      ]
    },
    "phase_3": {
      "timeline": "90 days",
      "controls": ["1.1", "6.1", "6.2", "11.1"],
      "tasks": [
        "Implement network segmentation",
        "Deploy vulnerability scanning",
        "Establish secure development lifecycle",
        "Schedule penetration testing"
      ]
    }
  },

  "references": [
    "https://www.pcisecuritystandards.org/",
    "PCI DSS v4.0 Requirements and Testing Procedures",
    "PCI DSS Quick Reference Guide v4.0",
    "OWASP Secure Coding Practices",
    "PCI DSS Prioritized Approach Tool"
  ]
}