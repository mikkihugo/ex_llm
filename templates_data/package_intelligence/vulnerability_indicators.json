{
  "pattern_id": "vulnerability_indicators",
  "name": "Security Vulnerability Risk Indicators",
  "description": "Identify packages with known vulnerabilities and assess security risk",
  "version": "1.0",
  "created_at": "2025-01-30",
  "artifact_type": "package_intelligence",

  "vulnerability_sources": [
    {
      "source_id": "nvd",
      "source": "NIST National Vulnerability Database",
      "url": "https://nvd.nist.gov/",
      "api_endpoint": "https://services.nvd.nist.gov/rest/json/cves/2.0",
      "description": "US government repository of vulnerability data",
      "update_frequency": "continuous",
      "coverage": "all_ecosystems"
    },
    {
      "source_id": "github_advisory",
      "source": "GitHub Security Advisory Database",
      "url": "https://github.com/advisories",
      "api_endpoint": "https://api.github.com/advisories",
      "description": "GitHub-hosted vulnerability database",
      "update_frequency": "continuous",
      "coverage": "github_hosted_packages"
    },
    {
      "source_id": "snyk",
      "source": "Snyk Vulnerability Database",
      "url": "https://security.snyk.io/",
      "api_endpoint": "https://api.snyk.io/v1/",
      "description": "Commercial vulnerability intelligence",
      "update_frequency": "continuous",
      "coverage": "multi_ecosystem"
    },
    {
      "source_id": "osv",
      "source": "Open Source Vulnerabilities",
      "url": "https://osv.dev/",
      "api_endpoint": "https://api.osv.dev/v1/",
      "description": "Google's open source vulnerability database",
      "update_frequency": "continuous",
      "coverage": "open_source"
    },
    {
      "source_id": "npm_audit",
      "source": "npm Security Advisories",
      "url": "https://www.npmjs.com/advisories",
      "description": "npm registry security advisories",
      "update_frequency": "continuous",
      "coverage": "npm_packages"
    },
    {
      "source_id": "rustsec",
      "source": "RustSec Advisory Database",
      "url": "https://rustsec.org/",
      "description": "Rust ecosystem security advisories",
      "update_frequency": "continuous",
      "coverage": "rust_crates"
    }
  ],

  "severity_levels": {
    "critical": {
      "cvss_range": "9.0-10.0",
      "description": "Easily exploitable, high impact, immediate action required",
      "response_time": "24 hours",
      "examples": ["Remote code execution", "Authentication bypass", "SQL injection"]
    },
    "high": {
      "cvss_range": "7.0-8.9",
      "description": "Exploitable with significant impact",
      "response_time": "7 days",
      "examples": ["Privilege escalation", "Data exposure", "XSS with session hijacking"]
    },
    "medium": {
      "cvss_range": "4.0-6.9",
      "description": "Moderate risk, requires specific conditions",
      "response_time": "30 days",
      "examples": ["Information disclosure", "Denial of service", "CSRF"]
    },
    "low": {
      "cvss_range": "0.1-3.9",
      "description": "Limited impact or difficult to exploit",
      "response_time": "90 days",
      "examples": ["Minor info leak", "Requires physical access", "Affects non-default config"]
    }
  },

  "vulnerability_categories": [
    {
      "category": "injection",
      "name": "Injection Vulnerabilities",
      "severity_weight": 1.5,
      "types": [
        "SQL Injection",
        "NoSQL Injection",
        "Command Injection",
        "LDAP Injection",
        "XPath Injection",
        "Template Injection",
        "Code Injection"
      ]
    },
    {
      "category": "memory_corruption",
      "name": "Memory Corruption",
      "severity_weight": 1.4,
      "types": [
        "Buffer Overflow",
        "Use After Free",
        "Double Free",
        "Integer Overflow",
        "Format String",
        "Heap Overflow"
      ]
    },
    {
      "category": "authentication",
      "name": "Authentication Flaws",
      "severity_weight": 1.3,
      "types": [
        "Authentication Bypass",
        "Session Fixation",
        "Weak Password Recovery",
        "Insufficient Authentication",
        "Credential Stuffing"
      ]
    },
    {
      "category": "cryptography",
      "name": "Cryptographic Issues",
      "severity_weight": 1.2,
      "types": [
        "Weak Encryption",
        "Insufficient Randomness",
        "Hard-coded Keys",
        "Missing Encryption",
        "Timing Attacks"
      ]
    },
    {
      "category": "prototype_pollution",
      "name": "Prototype Pollution",
      "severity_weight": 1.3,
      "types": [
        "JavaScript Prototype Pollution",
        "Object Injection",
        "Property Injection"
      ]
    },
    {
      "category": "supply_chain",
      "name": "Supply Chain Attacks",
      "severity_weight": 1.5,
      "types": [
        "Malicious Package",
        "Typosquatting",
        "Dependency Confusion",
        "Account Takeover",
        "Build Process Injection"
      ]
    }
  ],

  "example_vulnerabilities": [
    {
      "cve_id": "CVE-2021-44228",
      "name": "Log4Shell",
      "package": "log4j",
      "affected_versions": "2.0-beta9 to 2.14.1",
      "cvss_score": 10.0,
      "severity": "critical",
      "vulnerability_type": "Remote Code Execution",
      "description": "JNDI injection via logging allowing remote code execution",
      "fixed_version": "2.15.0",
      "workarounds": ["Set log4j2.formatMsgNoLookups=true"],
      "references": ["https://nvd.nist.gov/vuln/detail/CVE-2021-44228"]
    },
    {
      "cve_id": "CVE-2020-8174",
      "name": "Node.js napi_get_value_string_* Buffer Overflow",
      "package": "node",
      "affected_versions": "< 10.21.0, < 12.18.0, < 14.4.0",
      "cvss_score": 8.1,
      "severity": "high",
      "vulnerability_type": "Buffer Overflow",
      "description": "Buffer overflow in napi_get_value_string_* functions",
      "fixed_version": "14.4.0",
      "workarounds": ["Avoid using affected N-API functions"]
    },
    {
      "cve_id": "CVE-2021-23017",
      "name": "nginx DNS Resolver Vulnerability",
      "package": "nginx",
      "affected_versions": "0.6.18-1.20.0",
      "cvss_score": 7.7,
      "severity": "high",
      "vulnerability_type": "Off-by-one Error",
      "description": "Off-by-one error in DNS resolver",
      "fixed_version": "1.21.0",
      "workarounds": ["Disable DNS resolver if not needed"]
    },
    {
      "cve_id": "CVE-2022-24785",
      "name": "Moment.js Path Traversal",
      "package": "moment",
      "affected_versions": "< 2.29.2",
      "cvss_score": 7.5,
      "severity": "high",
      "vulnerability_type": "Path Traversal",
      "description": "Path traversal in locale loading",
      "fixed_version": "2.29.2",
      "workarounds": ["Sanitize locale inputs"]
    },
    {
      "cve_id": "CVE-2019-10744",
      "name": "Lodash Prototype Pollution",
      "package": "lodash",
      "affected_versions": "< 4.17.12",
      "cvss_score": 9.1,
      "severity": "critical",
      "vulnerability_type": "Prototype Pollution",
      "description": "Prototype pollution in defaultsDeep, merge, mergeWith",
      "fixed_version": "4.17.12",
      "workarounds": ["Avoid using affected functions with untrusted input"]
    }
  ],

  "security_checks": [
    {
      "check_id": "known_cves",
      "name": "Known CVEs Check",
      "description": "Check against CVE databases",
      "severity": "critical",
      "automation": "npm audit, cargo audit, safety check",
      "frequency": "continuous"
    },
    {
      "check_id": "abandoned_vulnerable",
      "name": "Abandoned Package with Vulnerabilities",
      "description": "Package has CVEs but is no longer maintained",
      "severity": "critical",
      "detection": "has_cves AND last_update > 730 days",
      "recommendation": "Immediate replacement required"
    },
    {
      "check_id": "zero_day_risk",
      "name": "Zero-day Risk Assessment",
      "description": "Package characteristics suggesting zero-day risk",
      "severity": "high",
      "indicators": [
        "Handles network input",
        "Parses complex formats",
        "Native code components",
        "Privileged operations",
        "Large attack surface"
      ]
    },
    {
      "check_id": "transitive_vulnerabilities",
      "name": "Transitive Dependency Vulnerabilities",
      "description": "Vulnerabilities in indirect dependencies",
      "severity": "high",
      "automation": "Deep dependency scanning",
      "recommendation": "Update or override transitive dependencies"
    },
    {
      "check_id": "eol_components",
      "name": "End-of-Life Components",
      "description": "Using versions past end-of-life",
      "severity": "high",
      "examples": ["Python 2.7", "Node.js < 14", "Angular < 12"],
      "recommendation": "Upgrade to supported versions"
    },
    {
      "check_id": "security_headers",
      "name": "Security Headers and Configurations",
      "description": "Missing security configurations",
      "severity": "medium",
      "checks": [
        "CSP headers",
        "HSTS configuration",
        "X-Frame-Options",
        "Secure cookie flags"
      ]
    }
  ],

  "vulnerability_assessment_framework": {
    "stages": [
      {
        "stage": "discovery",
        "description": "Identify all dependencies and versions",
        "tools": ["npm ls", "pip freeze", "cargo tree", "mix deps.tree"],
        "output": "dependency_manifest.json"
      },
      {
        "stage": "scanning",
        "description": "Scan for known vulnerabilities",
        "tools": ["npm audit", "snyk test", "safety check", "cargo audit"],
        "output": "vulnerability_report.json"
      },
      {
        "stage": "analysis",
        "description": "Analyze exploitability and impact",
        "factors": [
          "CVSS score",
          "Exploit availability",
          "Attack vector",
          "Required privileges",
          "User interaction needed"
        ],
        "output": "risk_assessment.json"
      },
      {
        "stage": "prioritization",
        "description": "Prioritize based on risk and context",
        "criteria": [
          "Internet-facing vs internal",
          "Data sensitivity",
          "Regulatory requirements",
          "Available fixes",
          "Workarounds"
        ],
        "output": "prioritized_actions.json"
      },
      {
        "stage": "remediation",
        "description": "Apply fixes and mitigations",
        "actions": [
          "Update to fixed version",
          "Apply patches",
          "Implement workarounds",
          "Add compensating controls",
          "Replace package"
        ],
        "output": "remediation_log.json"
      }
    ]
  },

  "remediation_strategies": [
    {
      "vulnerability_type": "Critical with fix available",
      "strategy": "immediate_update",
      "steps": [
        "Test fix in development",
        "Update in staging",
        "Monitor for issues",
        "Deploy to production",
        "Verify remediation"
      ]
    },
    {
      "vulnerability_type": "Critical without fix",
      "strategy": "mitigation_and_replacement",
      "steps": [
        "Implement workarounds",
        "Add WAF rules",
        "Increase monitoring",
        "Plan replacement",
        "Expedite migration"
      ]
    },
    {
      "vulnerability_type": "Supply chain attack",
      "strategy": "incident_response",
      "steps": [
        "Isolate affected systems",
        "Audit for compromise",
        "Remove malicious package",
        "Rotate credentials",
        "Implement additional controls"
      ]
    },
    {
      "vulnerability_type": "Transitive dependency",
      "strategy": "resolution_override",
      "steps": [
        "Override version in package manager",
        "Test compatibility",
        "Document override",
        "Monitor for updates",
        "Plan proper fix"
      ]
    }
  ],

  "preventive_measures": [
    {
      "measure": "dependency_pinning",
      "description": "Pin all dependencies to exact versions",
      "benefit": "Prevents surprise vulnerabilities from updates"
    },
    {
      "measure": "automated_scanning",
      "description": "Continuous vulnerability scanning in CI/CD",
      "benefit": "Early detection of vulnerabilities"
    },
    {
      "measure": "dependency_review",
      "description": "Manual review of new dependencies",
      "benefit": "Prevents introduction of risky packages"
    },
    {
      "measure": "sbom_generation",
      "description": "Generate Software Bill of Materials",
      "benefit": "Complete visibility into supply chain"
    },
    {
      "measure": "security_policies",
      "description": "Enforce security policies via tools",
      "benefit": "Automatic blocking of vulnerable packages"
    }
  ]
}