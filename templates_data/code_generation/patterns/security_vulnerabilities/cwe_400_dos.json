{
  "pattern_id": "cwe_400_dos",
  "name": "Uncontrolled Resource Consumption (Denial of Service)",
  "cwe": "CWE-400",
  "owasp_category": "A05:2021 - Security Misconfiguration",
  "severity": "high",
  "applicable_languages": ["python", "javascript", "java", "go", "php", "ruby", "csharp"],
  "description": "Failure to properly limit resource consumption allows attackers to cause denial of service",
  "vulnerability_patterns": [
    {
      "language": "python",
      "bad_code": [
        "# Unbounded regex\nimport re\nre.search(user_pattern, large_text)",
        "# No request limits\nwhile True:\n    process_request()",
        "# Unbounded loops\nfor i in range(user_input):\n    expensive_operation()"
      ],
      "good_code": [
        "# Timeout on regex\nimport signal\nsignal.alarm(5)\nre.search(pattern, text)",
        "# Rate limiting\nfrom flask_limiter import Limiter\nlimiter.limit('10/minute')",
        "# Bounded operations\nMAX_ITERATIONS = 1000\nfor i in range(min(user_input, MAX_ITERATIONS)):\n    operation()"
      ]
    },
    {
      "language": "javascript",
      "bad_code": [
        "// No rate limiting\napp.post('/api/process', (req, res) => {\n    heavyComputation(req.body.data);\n});",
        "// Unbounded array operations\nconst result = userArray.map(complexOperation);",
        "// Infinite loops possible\nwhile (condition) { process(); }"
      ],
      "good_code": [
        "// Rate limiting\nconst rateLimit = require('express-rate-limit');\nconst limiter = rateLimit({ windowMs: 60000, max: 10 });\napp.use('/api/', limiter);",
        "// Bounded operations\nconst MAX_ITEMS = 1000;\nuserArray.slice(0, MAX_ITEMS).map(operation);",
        "// Timeout protection\nsetTimeout(() => { abort = true; }, 5000);"
      ]
    }
  },
  "detection_rules": {
    "patterns": [
      "Unbounded loops with user input",
      "Missing rate limiting",
      "Recursive operations without limits",
      "Large memory allocations",
      "Synchronous blocking operations"
    ]
  },
  "remediation": {
    "steps": [
      "Implement rate limiting",
      "Set resource consumption limits",
      "Use timeouts for operations",
      "Implement circuit breakers",
      "Monitor resource usage"
    ]
  },
  "impact": {
    "severity_score": 7.5,
    "business_impact": "Service unavailability, resource exhaustion, degraded performance"
  },
  "metadata": {
    "version": "1.0.0",
    "tags": ["dos", "resource-exhaustion", "availability"]
  }
}
