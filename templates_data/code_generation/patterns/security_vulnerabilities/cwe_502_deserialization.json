{
  "pattern_id": "cwe_502_deserialization",
  "name": "Deserialization of Untrusted Data",
  "cwe": "CWE-502",
  "severity": "critical",
  "applicable_languages": ["python", "javascript", "java", "php", "ruby", "csharp"],
  "description": "Deserialization of untrusted data can lead to remote code execution",
  "vulnerability_patterns": [
    {
      "language": "python",
      "bad_code": [
        "pickle.loads(user_data)",
        "yaml.load(user_input)",
        "eval(serialized_data)"
      ],
      "good_code": [
        "json.loads(user_data)",
        "yaml.safe_load(user_input)",
        "# Use JSON instead of pickle for untrusted data"
      ]
    },
    {
      "language": "java",
      "bad_code": [
        "ObjectInputStream ois = new ObjectInputStream(userStream);\nois.readObject();"
      ],
      "good_code": [
        "// Use JSON or XML with validation\n// Implement ObjectInputFilter for Java 9+"
      ]
    }
  ],
  "detection_rules": {
    "patterns": ["pickle.loads", "readObject()", "unserialize()", "yaml.load"]
  },
  "remediation": {
    "steps": ["Use JSON instead", "Validate types", "Sign serialized data", "Use allowlists"]
  },
  "impact": {
    "severity_score": 9.8,
    "business_impact": "Remote code execution, complete system compromise"
  },
  "metadata": {
    "version": "1.0.0",
    "tags": ["deserialization", "rce", "critical"]
  }
}
