{
  "pattern_id": "cwe_295_cert_validation",
  "name": "Improper Certificate Validation",
  "cwe": "CWE-295",
  "severity": "high",
  "applicable_languages": ["python", "javascript", "java", "go", "ruby", "csharp"],
  "description": "Improper validation of certificates allows man-in-the-middle attacks",
  "vulnerability_patterns": [
    {
      "language": "python",
      "bad_code": [
        "requests.get(url, verify=False)",
        "ssl._create_unverified_context()",
        "urllib3.disable_warnings()"
      ],
      "good_code": [
        "requests.get(url, verify=True)",
        "ssl.create_default_context()",
        "# Always verify certificates in production"
      ]
    },
    {
      "language": "javascript",
      "bad_code": [
        "process.env['NODE_TLS_REJECT_UNAUTHORIZED'] = '0'",
        "rejectUnauthorized: false"
      ],
      "good_code": [
        "rejectUnauthorized: true",
        "// Use proper CA certificates"
      ]
    }
  ],
  "detection_rules": {
    "patterns": ["verify=False", "rejectUnauthorized: false", "TrustAllCerts"]
  },
  "remediation": {
    "steps": ["Always verify certificates", "Use proper CA bundles", "Pin certificates for sensitive apps"]
  },
  "impact": {
    "severity_score": 7.4,
    "business_impact": "Man-in-the-middle attacks, data interception"
  },
  "metadata": {
    "version": "1.0.0",
    "tags": ["tls", "ssl", "mitm", "certificates"]
  }
}
