{
  "name": "TSX Component Production Quality",
  "spec_version": "2.5.0",
  "capabilities": [
    "quality",
    "graph",
    "rag",
    "ai_navigation",
    "graph_db",
    "vector_db"
  ],
  "language": "typescript_tsx",
  "quality_level": "production",
  "description": "Production-grade quality standards for React/TSX components with AI navigation metadata (JSON/YAML/Mermaid) for billion-line codebases, focus on accessibility, stability, and composability",
  "changelog": {
    "2.5.0": {
      "date": "2025-10-24",
      "changes": [
        "Added 8 production readiness sections for production operations knowledge",
        "Sections: Performance Characteristics, Concurrency & Safety, Graceful Degradation, Version Compatibility, Configuration Guide, Observable Metrics, Troubleshooting, Architecture Decisions (ADR)",
        "Added 5 new interactive questions: error_tracking_integration, deployment_target, performance_critical, accessibility_wcag, backward_compatibility",
        "Added 10 new scoring weights for production readiness assessment",
        "Non-breaking: v2.4.0 modules remain valid, v2.5.0 sections are optional but recommended for production",
        "Tier-based implementation: Tier 1 (Performance, Metrics, Troubleshooting, Safety), Tier 2 (Config, Degradation, Compatibility), Tier 3 (ADR, Decisions)"
      ]
    },
    "2.3.0": {
      "date": "2025-01-14",
      "changes": [
        "Integrated self-awareness protocol for agent evolution",
        "Added documentation-first development requirements",
        "Enhanced duplicate prevention and architecture understanding",
        "Multi-language coordination with Elixir and Rust"
      ]
    },
    "2.2.0": {
      "date": "2025-01-14",
      "changes": [
        "Added human-first documentation structure (human content top, AI metadata below separator)",
        "Added component_identity JSON for vector DB disambiguation",
        "Added architecture_diagram (Mermaid) for component hierarchy visualization",
        "Added call_graph (YAML) for graph DB indexing (renders, uses_hook)",
        "Added anti_patterns for duplicate prevention and React best practices",
        "Added search_keywords for vector search optimization",
        "Enhanced prompts with documentation structure guidance",
        "Added scoring weights for AI-optimized metadata and documentation structure"
      ]
    },
    "2.0": {
      "date": "2025-01-08",
      "changes": [
        "Initial production template for React/TSX components with accessibility focus"
      ]
    }
  },
  "requirements": {
    "documentation": {
      "component_jsdoc": {
        "required": true,
        "min_length": 100,
        "must_include": [
          "description",
          "props",
          "examples",
          "accessibility",
          "human_content_first",
          "component_identity_json",
          "architecture_diagram",
          "call_graph_metadata",
          "anti_patterns"
        ],
        "should_include_v2_5_0": [
          "performance_characteristics",
          "concurrency_safety",
          "observable_metrics",
          "troubleshooting_guide",
          "graceful_degradation",
          "version_compatibility",
          "configuration_guide",
          "architecture_decisions"
        ],
        "ai_navigation": {
          "component_identity": {
            "format": "json",
            "required_fields": [
              "component",
              "purpose",
              "layer",
              "react_patterns",
              "related_components",
              "alternatives",
              "disambiguation"
            ],
            "description": "JSON block for vector DB disambiguation and graph DB indexing (React/TSX-specific)"
          },
          "architecture_diagram": {
            "format": "mermaid",
            "types": [
              "graph",
              "flowchart"
            ],
            "description": "Visual component hierarchy and hook usage for AI understanding"
          },
          "call_graph": {
            "format": "yaml",
            "required_fields": [
              "renders",
              "rendered_by",
              "uses_hooks",
              "depends_on"
            ],
            "description": "Machine-readable component graph for graph DB indexing (Neo4j, etc.)"
          },
          "anti_patterns": {
            "format": "markdown",
            "sections": [
              "duplicate_components",
              "usage_mistakes",
              "react_antipatterns",
              "a11y_violations"
            ],
            "description": "Explicit duplicate prevention and React/accessibility best practices"
          },
          "search_keywords": {
            "format": "comma_separated",
            "min_count": 5,
            "description": "Keywords for vector search optimization (10+ recommended)"
          },
          "performance_characteristics": {
            "format": "markdown",
            "when": "component has measurable render behavior",
            "should_include": [
              "render_count_typical",
              "memory_footprint",
              "re_render_triggers",
              "benchmarks",
              "optimization_techniques"
            ],
            "description": "Performance characteristics for production deployment decisions (React DevTools Profiler)"
          },
          "concurrency_safety": {
            "format": "markdown",
            "when": "component has async operations or state updates",
            "should_include": [
              "race_condition_risks",
              "state_update_batching",
              "concurrent_rendering",
              "cleanup_requirements",
              "recommended_usage_patterns"
            ],
            "description": "Concurrency and safety guarantees for React 18+ concurrent features"
          },
          "observable_metrics": {
            "format": "markdown",
            "when": "component emits analytics or logs",
            "should_include": [
              "analytics_events",
              "error_boundaries",
              "performance_marks",
              "user_interaction_tracking",
              "example_dashboards"
            ],
            "description": "Documented analytics events and monitoring guidance"
          },
          "troubleshooting_guide": {
            "format": "markdown",
            "when": "component might encounter runtime issues",
            "should_include": [
              "common_problems",
              "root_causes",
              "diagnostic_steps",
              "solutions",
              "react_devtools_usage",
              "prevention_strategies"
            ],
            "description": "Common issues, diagnostics, and solutions for production debugging"
          },
          "graceful_degradation": {
            "format": "markdown",
            "when": "component has external dependencies or data loading",
            "should_include": [
              "failure_scenarios",
              "fallback_ui",
              "error_boundary_usage",
              "loading_states",
              "recovery_mechanism"
            ],
            "description": "Failure modes and degradation patterns for fault tolerance (Suspense + ErrorBoundary)"
          },
          "version_compatibility": {
            "format": "markdown",
            "when": "component has dependencies or breaking history",
            "should_include": [
              "react_versions_supported",
              "typescript_versions",
              "key_dependencies",
              "breaking_changes_history",
              "migration_guide"
            ],
            "description": "Version compatibility matrix and breaking changes documentation"
          },
          "configuration_guide": {
            "format": "markdown",
            "when": "component has configurable behavior",
            "should_include": [
              "props_reference",
              "theme_customization",
              "css_variables",
              "feature_flags",
              "accessibility_options"
            ],
            "description": "Configuration options and customization guidance"
          },
          "architecture_decisions": {
            "format": "markdown",
            "when": "component has non-obvious design choices",
            "should_include": [
              "decision_id",
              "problem_statement",
              "alternatives_considered",
              "chosen_solution_and_rationale",
              "consequences",
              "related_decisions"
            ],
            "description": "Architecture Decision Records (ADR) explaining design rationale"
          }
        }
      }
    },
    "props": {
      "explicit_interface": true,
      "no_any": true,
      "prefer_discriminated_unions": true
    },
    "a11y": {
      "required": true,
      "must_address": [
        "aria-labels",
        "focus-order",
        "keyboard-nav"
      ]
    },
    "testing": {
      "framework": "vitest + @testing-library/react",
      "required": true,
      "coverage_target": 85,
      "test_types": [
        "behavior",
        "a11y",
        "snapshot_optional"
      ]
    },
    "performance": {
      "guidelines": [
        "avoid inline functions in hot lists",
        "memoize expensive renders"
      ],
      "metrics": [
        "render_count",
        "hook_allocation"
      ]
    }
  },
  "questions": [
    {
      "name": "error_tracking_integration",
      "type": "choice",
      "prompt": "Error tracking integration for production monitoring?",
      "choices": [
        "none",
        "sentry",
        "datadog",
        "custom"
      ],
      "default": "none",
      "hint": "Sentry/Datadog integration for automatic error tracking with React ErrorBoundary"
    },
    {
      "name": "deployment_target",
      "type": "choice",
      "prompt": "Deployment target?",
      "choices": [
        "browser",
        "server_side_rendering",
        "static_export",
        "hybrid"
      ],
      "default": "browser",
      "hint": "Browser for SPA, SSR for Next.js/Remix, static for prerendering, hybrid for both"
    },
    {
      "name": "performance_critical",
      "type": "boolean",
      "prompt": "Is this a performance-critical component?",
      "default": false,
      "hint": "Triggers: React.memo, useMemo, useCallback, virtualization, profiling"
    },
    {
      "name": "accessibility_wcag",
      "type": "choice",
      "prompt": "WCAG accessibility level target?",
      "choices": [
        "none",
        "wcag_a",
        "wcag_aa",
        "wcag_aaa"
      ],
      "default": "wcag_aa",
      "hint": "WCAG AA is standard for most apps, AAA for government/healthcare"
    },
    {
      "name": "backward_compatibility",
      "type": "boolean",
      "prompt": "Must maintain backward compatibility?",
      "default": true,
      "hint": "Triggers: deprecation warnings, migration guides, version matrix documentation"
    }
  ],
  "prompts": {
    "code_generation": "Generate production-quality React/TSX component for: {task}\n\nREQUIREMENTS:\n\n1. DOCUMENTATION STRUCTURE (human-first):\n\nHUMAN CONTENT (Top ~80 lines in JSDoc):\n/**\n * Component Name - Brief description\n *\n * **Purpose:** What this component does (clear statement)\n *\n * ## Quick Start\n * ```tsx\n * import { MyComponent } from './MyComponent';\n *\n * function App() {\n *   return <MyComponent name=\"example\" />;\n * }\n * ```\n *\n * ## Props\n * - `name` (string, required) - Display name\n * - `onClick` (function, optional) - Click handler\n *\n * ## Accessibility\n * - ARIA labels for screen readers\n * - Keyboard navigation support\n * - Focus management\n *\n * ## Examples\n * ```tsx\n * // Basic usage\n * <MyComponent name=\"John\" />\n *\n * // With event handler\n * <MyComponent name=\"Jane\" onClick={handleClick} />\n * ```\n */\n\nSEPARATOR:\n---\n## AI Navigation Metadata\n// The sections below provide structured metadata for AI assistants,\n// graph databases (Neo4j), and vector databases (pgvector).\n\nAI METADATA (Below separator in JSDoc):\n- Component Identity (JSON in code block)\n- Architecture Diagram (Mermaid - component tree)\n- Call Graph (YAML - renders, hooks)\n- Anti-Patterns (Markdown list)\n- Search Keywords (comma-separated)\n\n2. CODE QUALITY:\n- TypeScript interface for props (no any)\n- Accessibility (aria-labels, keyboard nav)\n- Vitest + @testing-library/react tests\n- Memoization for expensive renders\n- No inline functions in lists\n\n3. AI NAVIGATION (in component JSDoc):\n\nComponent Identity (JSON):\n```json\n{\n  \"component\": \"MyComponent\",\n  \"purpose\": \"Clear unique purpose statement\",\n  \"layer\": \"page|layout|component|hook\",\n  \"react_patterns\": [\"useState\", \"useEffect\", \"custom hooks\"],\n  \"related_components\": [\"ParentComponent\", \"ChildComponent\"],\n  \"alternatives\": {\n    \"OldComponent\": \"Legacy - use this component instead\",\n    \"SimilarComponent\": \"Different use case - see disambiguation\"\n  },\n  \"disambiguation\": {\n    \"vs_OldComponent\": \"This = TypeScript + hooks. OldComponent = class component\",\n    \"vs_SimilarComponent\": \"This = form input. SimilarComponent = display only\"\n  }\n}\n```\n\nArchitecture (Mermaid):\n```mermaid\ngraph TB\n    App[App] --> MyComponent[MyComponent]\n    MyComponent --> Button[Button]\n    MyComponent --> Input[Input]\n    MyComponent -.uses.-> useCustomHook[useCustomHook]\n```\n\nCall Graph (YAML):\n```yaml\nrenders:\n  - component: Button\n    purpose: Submit action\n    critical: true\n  - component: Input\n    purpose: User input\n    critical: true\n\nrendered_by:\n  - component: App\n    purpose: Main application\n    frequency: high\n\nuses_hooks:\n  - useState (React)\n  - useEffect (React)\n  - useCustomHook (custom)\n\ndepends_on:\n  - react (required)\n  - react-dom (required)\n```\n\nAnti-Patterns:\n\u274c DO NOT create 'MyComponentWrapper' - use this component directly\n\u274c DO NOT use inline arrow functions in map() - memoize instead\n\u274c DO NOT forget aria-label - accessibility required\n\u274c DO NOT use 'any' type - explicit interfaces required\n\nSearch Keywords:\nreact-component, typescript-tsx, accessibility, hooks, production-ready, a11y\n\nOUTPUT CODE ONLY (with enhanced JSDoc)."
  },
  "scoring_weights": {
    "has_component_jsdoc": 1.0,
    "has_tests": 1.0,
    "a11y_compliant": 1.0,
    "typescript_strict": 1.0,
    "no_any_type": 0.9,
    "has_component_identity_json": 0.95,
    "has_architecture_diagram": 0.9,
    "has_call_graph_yaml": 0.9,
    "has_anti_patterns": 0.85,
    "has_search_keywords": 0.8,
    "human_content_first": 0.9,
    "clear_separation": 0.85,
    "ai_metadata_explained": 0.8,
    "graph_db_ready": 0.9,
    "vector_db_optimized": 0.9,
    "has_performance_characteristics": 0.9,
    "has_concurrency_safety_docs": 0.85,
    "has_degradation_patterns": 0.8,
    "has_version_compatibility": 0.85,
    "has_configuration_guide": 0.8,
    "has_observable_metrics": 0.9,
    "has_troubleshooting_guide": 0.75,
    "has_architecture_decisions": 0.7,
    "production_deployment_ready": 0.95,
    "security_reviewed": 0.95
  },
  "graph_model": {
    "version": 2,
    "node_types": {
      "component": {
        "id_format": "tsx://{path}#{component}",
        "merge_keys": [
          "component"
        ]
      },
      "hook": {
        "id_format": "tsx://{path}#hook/{name}",
        "merge_keys": [
          "name"
        ]
      }
    },
    "edge_types": {
      "renders": {
        "from": "component",
        "to": "component",
        "weight": 0.6
      },
      "uses_hook": {
        "from": "component",
        "to": "hook",
        "weight": 0.9
      }
    },
    "extraction_rules": {
      "component_detection": "export function | const Name: React.FC",
      "hook_detection": "function names starting with use",
      "a11y_flags": "scan JSX props for aria-*",
      "ai_metadata_extraction": "parse JSON/YAML/Mermaid from JSDoc comments"
    },
    "temporal": {
      "track": true,
      "fields": [
        "first_seen",
        "last_modified"
      ],
      "update_policy": "touch_last_modified_on_signature_change"
    },
    "error_semantics": {
      "severity_enum": [
        "fatal",
        "transient",
        "validation"
      ],
      "classification_enum": [
        "user_input",
        "external_dependency"
      ],
      "default_severity": "validation"
    }
  },
  "last_updated": "2025-01-14",
  "parent_pattern": null
}