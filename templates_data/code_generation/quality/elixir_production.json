{
  "name": "Elixir Production Quality",
  "spec_version": "2.6.0",
  "capabilities": [
    "quality",
    "graph",
    "rag",
    "ai_navigation",
    "graph_db",
    "vector_db"
  ],
  "language": "elixir",
  "quality_level": "production",
  "description": "Production-grade quality standards for Elixir code with AI navigation metadata (JSON/YAML/Mermaid) for billion-line codebases, graph DB indexing (Neo4j), and vector DB optimization (pgvector)",
  "changelog": {
    "2.6.0": {
      "date": "2025-10-26",
      "changes": [
        "Added 6 gold standard production sections for true production readiness",
        "Security section: authentication, authorization, input validation, cryptography, OWASP, headers, API security",
        "Deployment section: containerization, CI/CD, infrastructure, health checks, scaling, DR",
        "API Design section: REST, GraphQL, versioning, OpenAPI documentation",
        "Data Persistence section: migrations, transactions, caching, event sourcing, retention",
        "Operational Excellence section: monitoring, SLA/SLO, incident management, cost optimization",
        "Compliance section: GDPR, CCPA, PCI DSS, HIPAA, SOX, audit logging",
        "Non-breaking: v2.5.0 modules remain valid, new sections are strongly recommended for production"
      ]
    },
    "2.5.0": {
      "date": "2025-10-24",
      "changes": [
        "Added 8 production readiness sections for production operations knowledge",
        "Sections: Performance Characteristics, Concurrency & Safety, Graceful Degradation, Version Compatibility, Configuration Guide, Observable Metrics, Troubleshooting, Architecture Decisions (ADR)",
        "Added 5 new interactive questions: error_tracking_integration, otp_release_ready, performance_critical, multi_tenancy, backward_compatibility",
        "Added 10 new scoring weights for production readiness assessment",
        "Non-breaking: v2.4.0 modules remain valid, v2.5.0 sections are optional but recommended for production",
        "Tier-based implementation: Tier 1 (Performance, Metrics, Troubleshooting, Safety), Tier 2 (Config, Degradation, Compatibility), Tier 3 (ADR, Decisions)"
      ]
    },
    "2.4.0": {
      "date": "2025-10-24",
      "changes": [
        "Added interactive questions for 2-way template generation",
        "Questions include: GenServer usage, supervisor strategy, ETS caching, telemetry, circuit breaker, documentation level",
        "Enables answer tracking and CentralCloud intelligence gathering",
        "Supports conditional questions (when clause) based on previous answers"
      ]
    },
    "2.3.0": {
      "date": "2025-01-15",
      "changes": [
        "Integrated self-awareness protocol for agent evolution",
        "Added documentation-first development requirements",
        "Enhanced duplicate prevention and architecture understanding"
      ]
    },
    "2.2.0": {
      "date": "2025-01-14",
      "changes": [
        "Enhanced documentation prompt with explicit human-first structure guidance",
        "Added 3 new scoring weights: human_content_first, clear_separation, ai_metadata_explained",
        "Clarified separation between human content (top) and AI metadata (below separator)"
      ]
    },
    "2.1.1": {
      "date": "2025-01-13",
      "changes": [
        "Added explicit rule: Use comments (# ...) for private functions, NOT @doc",
        "Added rationale: @doc on defp/defmacrop causes compilation warnings",
        "Updated code_generation prompt with IMPORTANT note about private function docs"
      ]
    },
    "2.1": {
      "date": "2025-01-12",
      "changes": [
        "Added module_identity JSON for vector DB disambiguation",
        "Added architecture_diagram (Mermaid) for visual understanding",
        "Added decision_tree (Mermaid) for usage patterns",
        "Added call_graph (YAML) for graph DB indexing",
        "Added data_flow (Mermaid sequence) for orchestration",
        "Added anti_patterns for duplicate prevention",
        "Added search_keywords for vector search optimization",
        "Enhanced scoring_weights for AI-optimized metadata"
      ]
    },
    "2.0": {
      "date": "2025-01-10",
      "changes": [
        "Initial production template with RAG support"
      ]
    }
  },
  "requirements": {
    "documentation": {
      "moduledoc": {
        "required": true,
        "min_length": 100,
        "must_include": [
          "overview",
          "examples",
          "usage_patterns",
          "module_identity_json",
          "architecture_diagram",
          "call_graph_metadata",
          "anti_patterns"
        ],
        "should_include_v2_5_0": [
          "performance_characteristics",
          "concurrency_safety",
          "observable_metrics",
          "troubleshooting_guide",
          "graceful_degradation",
          "version_compatibility",
          "configuration_guide",
          "architecture_decisions"
        ],
        "ai_navigation": {
          "module_identity": {
            "format": "json",
            "required_fields": [
              "module",
              "purpose",
              "role",
              "layer",
              "alternatives",
              "disambiguation"
            ],
            "description": "JSON block for vector DB disambiguation and graph DB indexing"
          },
          "architecture_diagram": {
            "format": "mermaid",
            "types": [
              "graph",
              "sequence",
              "flowchart"
            ],
            "description": "Visual architecture for AI understanding of call flow and data flow"
          },
          "decision_tree": {
            "format": "mermaid",
            "when": "module has multiple usage patterns",
            "description": "Mermaid flowchart showing when/how to use different functions"
          },
          "call_graph": {
            "format": "yaml",
            "required_fields": [
              "calls_out",
              "called_by",
              "depends_on",
              "supervision"
            ],
            "description": "Machine-readable call graph for graph DB indexing (Neo4j, etc.)"
          },
          "data_flow": {
            "format": "mermaid",
            "type": "sequence",
            "when": "module orchestrates multiple components",
            "description": "Sequence diagram showing data flow through system"
          },
          "anti_patterns": {
            "format": "markdown",
            "must_include": [
              "what_not_to_create",
              "what_not_to_call_directly",
              "duplicate_prevention"
            ],
            "description": "Explicit anti-patterns to prevent AI from creating duplicates"
          },
          "search_keywords": {
            "format": "text",
            "min_keywords": 10,
            "description": "Comma-separated keywords for vector DB semantic search optimization"
          },
          "performance_characteristics": {
            "format": "markdown",
            "when": "module has measurable computational behavior",
            "should_include": [
              "time_complexity",
              "space_complexity",
              "typical_latencies",
              "benchmarks"
            ],
            "description": "Performance characteristics for production deployment decisions"
          },
          "concurrency_safety": {
            "format": "markdown",
            "when": "module has state or external calls",
            "should_include": [
              "process_safety",
              "thread_safety",
              "atomicity_guarantees",
              "race_condition_risks",
              "recommended_usage_patterns"
            ],
            "description": "Concurrency and thread safety guarantees for safe concurrent usage"
          },
          "observable_metrics": {
            "format": "markdown",
            "when": "module emits telemetry events",
            "should_include": [
              "complete_telemetry_event_list",
              "measurement_values",
              "metadata_included",
              "example_handlers",
              "dashboard_suggestions"
            ],
            "description": "Documented telemetry events and monitoring guidance"
          },
          "troubleshooting_guide": {
            "format": "markdown",
            "when": "module might encounter runtime issues",
            "should_include": [
              "common_problems",
              "root_causes",
              "diagnostic_steps",
              "solutions",
              "monitoring_commands",
              "prevention_strategies"
            ],
            "description": "Common issues, diagnostics, and solutions for production debugging"
          },
          "graceful_degradation": {
            "format": "markdown",
            "when": "module has external dependencies or caching",
            "should_include": [
              "failure_scenarios",
              "fallback_behavior",
              "user_impact",
              "recovery_mechanism",
              "testing_guidance"
            ],
            "description": "Failure modes and degradation patterns for fault tolerance"
          },
          "version_compatibility": {
            "format": "markdown",
            "when": "module has dependencies or breaking history",
            "should_include": [
              "elixir_versions_supported",
              "otp_versions_supported",
              "key_dependencies",
              "breaking_changes_history",
              "deprecation_timeline"
            ],
            "description": "Version compatibility matrix and breaking changes documentation"
          },
          "configuration_guide": {
            "format": "markdown",
            "when": "module has configurable behavior",
            "should_include": [
              "environment_variables",
              "runtime_options",
              "tuning_recommendations",
              "impact_of_each_setting",
              "safety_constraints"
            ],
            "description": "Configuration options and runtime tuning guidance"
          },
          "architecture_decisions": {
            "format": "markdown",
            "when": "module has non-obvious design choices",
            "should_include": [
              "decision_id",
              "problem_statement",
              "alternatives_considered",
              "chosen_solution_and_rationale",
              "consequences",
              "related_decisions"
            ],
            "description": "Architecture Decision Records (ADR) explaining design rationale"
          }
        }
      },
      "doc": {
        "required_for": [
          "all_public_functions",
          "callbacks"
        ],
        "min_length": 50,
        "must_include": [
          "description",
          "examples",
          "edge_cases"
        ],
        "private_functions": {
          "use_comments_not_doc": true,
          "rationale": "@doc attributes are discarded for defp/defmacrop and cause compilation warnings"
        }
      },
      "typedoc": {
        "required_for": [
          "public_types"
        ]
      }
    },
    "type_specs": {
      "required": true,
      "required_for": [
        "all_public_functions",
        "callbacks",
        "struct_fields"
      ],
      "style": "strict",
      "dialyzer": {
        "enabled": true,
        "warnings_as_errors": true
      }
    },
    "error_handling": {
      "style": "tagged_tuples",
      "required_pattern": "{:ok, result} | {:error, reason}",
      "no_raise_in_public_api": true,
      "explicit_errors": "required",
      "error_reasons": {
        "must_be_typed": true,
        "must_be_documented": true
      },
      "with_statements": {
        "required_for_error_chains": true,
        "else_clause_required": true
      }
    },
    "testing": {
      "required": true,
      "framework": "ExUnit",
      "coverage_target": 85,
      "test_types": [
        "unit_tests",
        "integration_tests",
        "property_tests",
        "edge_cases",
        "error_conditions",
        "concurrency_tests"
      ],
      "doctests": {
        "required": true,
        "for": "all_public_functions"
      },
      "async_tests": {
        "required_when_possible": true
      }
    },
    "code_style": {
      "naming_convention": "snake_case",
      "max_function_length": 30,
      "pattern_matching": "required",
      "formatter": {
        "required": true,
        "config": ".formatter.exs"
      },
      "credo": {
        "required": true,
        "strictness": "strict"
      },
      "pipe_operator": {
        "preferred": true,
        "min_chain_length": 2
      }
    },
    "code_smells": {
      "forbidden": [
        "FIXME",
        "XXX",
        "HACK",
        "unused_variables",
        "unused_functions"
      ],
      "warnings": [
        "TODO"
      ]
    },
    "performance": {
      "tail_recursion": {
        "required_for_recursive_functions": true
      },
      "lazy_evaluation": {
        "use_streams_for_large_data": true
      },
      "avoid_n_plus_one": true
    },
    "observability": {
      "telemetry": {
        "required": true,
        "events_for": [
          "public_operations",
          "errors",
          "performance_metrics"
        ]
      },
      "logging": {
        "use_logger": true,
        "structured_logging": true,
        "log_levels_appropriate": true
      }
    },
    "rag_support": {
      "semantic_chunking": {
        "module_level": true,
        "function_level": true,
        "include_context": true
      },
      "metadata": {
        "tags": "required",
        "complexity_score": "auto_calculate",
        "dependencies": "explicit",
        "similar_patterns": "link_to_other_modules"
      },
      "ai_hints": {
        "usage_examples": "required_in_moduledoc",
        "common_mistakes": "document_in_moduledoc",
        "performance_notes": "include_if_relevant"
      },
      "graph_db_optimization": {
        "call_graph_yaml": "required_for_services",
        "relationship_metadata": "explicit",
        "dependency_tree": "machine_readable"
      },
      "vector_db_optimization": {
        "search_keywords": "required",
        "purpose_statement": "clear_and_unique",
        "disambiguation_vs_similar": "explicit"
      }
    },
    "security": {
      "authentication": {
        "required_for": ["api_endpoints", "admin_functions"],
        "patterns": ["jwt", "oauth2", "api_keys"],
        "session_management": "stateless_preferred",
        "token_expiry": "required",
        "refresh_tokens": "recommended"
      },
      "authorization": {
        "rbac": "role_based_access_control",
        "permissions": "granular_per_resource",
        "policy_engine": "recommended_for_complex_rules",
        "audit_logging": "required_for_sensitive_ops"
      },
      "input_validation": {
        "required": true,
        "sanitization": "all_user_inputs",
        "parameterized_queries": "required_for_db",
        "rate_limiting": {
          "per_endpoint": true,
          "per_user": true,
          "algorithms": ["token_bucket", "sliding_window"]
        },
        "file_upload_validation": {
          "size_limits": "required",
          "type_validation": "required",
          "virus_scanning": "recommended"
        }
      },
      "cryptography": {
        "password_hashing": {
          "algorithm": "argon2id_or_bcrypt",
          "min_rounds": 10,
          "salt": "required_unique"
        },
        "data_encryption": {
          "at_rest": "aes_256_gcm",
          "in_transit": "tls_1_3_minimum",
          "key_rotation": "quarterly_recommended"
        },
        "secrets_management": {
          "storage": "never_in_code",
          "environment_variables": "acceptable",
          "vault_integration": "recommended_production"
        }
      },
      "owasp_compliance": {
        "injection_prevention": "parameterized_queries",
        "broken_authentication": "mfa_recommended",
        "sensitive_data_exposure": "encryption_required",
        "xml_external_entities": "disable_dtd_processing",
        "broken_access_control": "rbac_required",
        "security_misconfiguration": "secure_defaults",
        "xss_prevention": "output_encoding",
        "insecure_deserialization": "avoid_or_validate",
        "using_vulnerable_components": "dependency_scanning",
        "insufficient_logging": "audit_trail_required"
      },
      "security_headers": {
        "content_security_policy": "required",
        "x_frame_options": "DENY_or_SAMEORIGIN",
        "x_content_type_options": "nosniff",
        "strict_transport_security": "required_for_https",
        "x_xss_protection": "1_mode_block",
        "referrer_policy": "strict_origin_when_cross_origin",
        "permissions_policy": "restrictive_by_default"
      },
      "api_security": {
        "rate_limiting": "required",
        "api_key_rotation": "90_days",
        "cors_configuration": "whitelist_only",
        "request_signing": "recommended_for_webhooks",
        "idempotency_keys": "required_for_mutations"
      }
    },
    "deployment": {
      "containerization": {
        "docker": {
          "multi_stage_builds": "required",
          "non_root_user": "required",
          "minimal_base_image": "alpine_or_distroless",
          "security_scanning": "required",
          "layer_caching": "optimize"
        },
        "kubernetes": {
          "resource_limits": "required",
          "security_context": "non_root_readonly",
          "network_policies": "required",
          "pod_security_policies": "restricted",
          "secrets_management": "external_secrets_operator"
        }
      },
      "ci_cd": {
        "pipeline_stages": ["lint", "test", "security_scan", "build", "deploy"],
        "automated_testing": {
          "unit_tests": "required",
          "integration_tests": "required",
          "security_tests": "required",
          "performance_tests": "recommended"
        },
        "quality_gates": {
          "code_coverage": 85,
          "security_score": "A",
          "performance_regression": "block_if_detected"
        },
        "deployment_strategies": {
          "blue_green": "recommended",
          "canary": "for_critical_changes",
          "rolling": "acceptable",
          "feature_flags": "required"
        }
      },
      "infrastructure": {
        "health_checks": {
          "liveness_probe": "required",
          "readiness_probe": "required",
          "startup_probe": "recommended"
        },
        "scaling": {
          "horizontal": "preferred",
          "vertical": "temporary_only",
          "auto_scaling": "cpu_and_memory_based"
        },
        "observability": {
          "distributed_tracing": "required",
          "centralized_logging": "required",
          "metrics_aggregation": "required",
          "alerting": "pagerduty_or_opsgenie"
        },
        "disaster_recovery": {
          "backup_strategy": "3_2_1_rule",
          "rto": "4_hours",
          "rpo": "1_hour",
          "chaos_engineering": "recommended"
        }
      }
    },
    "api_design": {
      "rest": {
        "url_structure": "resource_based",
        "http_methods": "semantic_usage",
        "status_codes": "rfc_compliant",
        "content_negotiation": "accept_headers",
        "pagination": {
          "style": "cursor_or_offset",
          "page_size_limits": "required",
          "total_count": "optional_header"
        },
        "filtering": "query_parameters",
        "sorting": "sort_parameter",
        "field_selection": "sparse_fieldsets",
        "bulk_operations": "batch_endpoints"
      },
      "graphql": {
        "schema_design": "graph_based",
        "query_complexity": "limited",
        "depth_limiting": "required",
        "rate_limiting": "query_cost_based",
        "batching": "dataloader_pattern",
        "subscriptions": "websocket_based"
      },
      "versioning": {
        "strategy": "url_or_header",
        "deprecation_policy": "6_months_minimum",
        "sunset_headers": "required",
        "migration_guides": "required",
        "backward_compatibility": "2_versions_minimum"
      },
      "documentation": {
        "openapi": "version_3_minimum",
        "examples": "required_per_endpoint",
        "error_codes": "comprehensive_list",
        "rate_limits": "documented",
        "authentication": "clear_examples"
      }
    },
    "data_persistence": {
      "database": {
        "migrations": {
          "tool": "ecto_or_similar",
          "reversible": "required",
          "testing": "required",
          "zero_downtime": "preferred",
          "data_migrations": "separate_from_schema"
        },
        "transactions": {
          "isolation_levels": "explicit",
          "retry_logic": "exponential_backoff",
          "deadlock_handling": "required",
          "distributed_transactions": "avoid_if_possible"
        },
        "optimization": {
          "indexes": "evidence_based",
          "query_analysis": "explain_analyze",
          "connection_pooling": "required",
          "prepared_statements": "recommended"
        }
      },
      "caching": {
        "strategies": ["cache_aside", "write_through", "write_behind"],
        "invalidation": "event_based_preferred",
        "ttl": "context_appropriate",
        "cache_warming": "for_critical_data",
        "distributed_cache": "redis_or_memcached"
      },
      "event_sourcing": {
        "when_applicable": "audit_requirements",
        "event_store": "append_only",
        "projections": "eventually_consistent",
        "snapshots": "periodic",
        "replay_capability": "required"
      },
      "data_retention": {
        "policies": "documented",
        "archival": "automated",
        "deletion": "soft_delete_then_hard",
        "gdpr_compliance": "right_to_be_forgotten"
      }
    },
    "operational_excellence": {
      "monitoring": {
        "golden_signals": ["latency", "traffic", "errors", "saturation"],
        "custom_metrics": "business_relevant",
        "dashboards": "role_specific",
        "alerting": {
          "severity_levels": ["critical", "warning", "info"],
          "escalation_policies": "defined",
          "runbook_links": "required",
          "deduplication": "required"
        }
      },
      "performance": {
        "sla_slo": {
          "availability": "99.9_minimum",
          "latency_p95": "200ms_api_calls",
          "latency_p99": "1s_api_calls",
          "error_rate": "less_than_1_percent"
        },
        "budgets": {
          "performance_budget": "defined",
          "error_budget": "tracked",
          "latency_budget": "per_endpoint"
        },
        "optimization": {
          "profiling": "regular",
          "load_testing": "required",
          "capacity_planning": "quarterly",
          "bottleneck_analysis": "continuous"
        }
      },
      "incident_management": {
        "on_call_rotation": "defined",
        "incident_response": {
          "severity_classification": "required",
          "communication_channels": "defined",
          "war_room_procedures": "documented",
          "postmortem": "blameless_required"
        },
        "runbooks": {
          "common_issues": "documented",
          "troubleshooting_guides": "step_by_step",
          "recovery_procedures": "tested",
          "contact_information": "updated"
        }
      },
      "cost_optimization": {
        "resource_monitoring": "continuous",
        "unused_resources": "automated_cleanup",
        "reserved_capacity": "where_predictable",
        "spot_instances": "for_non_critical",
        "data_lifecycle": "tiered_storage"
      }
    },
    "compliance": {
      "data_privacy": {
        "gdpr": {
          "consent_management": "explicit",
          "data_portability": "supported",
          "right_to_deletion": "automated",
          "breach_notification": "72_hours",
          "privacy_by_design": "required"
        },
        "ccpa": {
          "opt_out": "supported",
          "data_disclosure": "45_days",
          "non_discrimination": "enforced"
        }
      },
      "industry_specific": {
        "pci_dss": {
          "when": "payment_processing",
          "scope_reduction": "tokenization",
          "network_segmentation": "required",
          "encryption": "required"
        },
        "hipaa": {
          "when": "healthcare_data",
          "encryption": "required",
          "access_controls": "strict",
          "audit_logs": "comprehensive"
        },
        "sox": {
          "when": "financial_reporting",
          "change_management": "documented",
          "separation_of_duties": "enforced",
          "audit_trail": "immutable"
        }
      },
      "audit": {
        "logging": {
          "what": ["who", "what", "when", "where", "why"],
          "retention": "7_years_minimum",
          "integrity": "tamper_proof",
          "access": "restricted"
        },
        "reporting": {
          "regular_audits": "quarterly",
          "compliance_reports": "automated",
          "vulnerability_reports": "monthly"
        }
      }
    }
  },
  "questions": [
    {
      "name": "use_genserver",
      "type": "boolean",
      "prompt": "Should this be implemented as a GenServer (stateful process)?",
      "default": false,
      "hint": "Use GenServer for: state management, serialized operations, caching, resource pooling",
      "validator": "{{#if use_genserver}}true{{else}}false{{/if}}"
    },
    {
      "name": "supervisor_strategy",
      "type": "choice",
      "prompt": "What supervision strategy should be used?",
      "choices": [
        "one_for_one",
        "rest_for_one",
        "one_for_all"
      ],
      "default": "one_for_one",
      "when": "{{use_genserver}}",
      "hint": "one_for_one: restart only failed child (most common). rest_for_one: restart failed + later siblings. one_for_all: restart all children"
    },
    {
      "name": "use_ets",
      "type": "boolean",
      "prompt": "Include ETS table for caching?",
      "default": false,
      "when": "{{use_genserver}}",
      "hint": "ETS provides fast in-memory lookups. Useful for caching, lookup tables, or shared state"
    },
    {
      "name": "ets_ttl_minutes",
      "type": "number",
      "prompt": "Cache TTL in minutes?",
      "default": 5,
      "when": "{{use_ets}}",
      "hint": "Time-to-live for cached entries (0 for no expiration)"
    },
    {
      "name": "include_telemetry",
      "type": "boolean",
      "prompt": "Include telemetry instrumentation?",
      "default": true,
      "hint": "Telemetry events for monitoring, metrics, and observability"
    },
    {
      "name": "include_circuit_breaker",
      "type": "boolean",
      "prompt": "Include circuit breaker for external calls?",
      "default": false,
      "hint": "Prevents cascading failures when calling external services or APIs"
    },
    {
      "name": "documentation_level",
      "type": "choice",
      "prompt": "Documentation detail level?",
      "choices": [
        "minimal",
        "standard",
        "comprehensive"
      ],
      "default": "comprehensive",
      "hint": "minimal: basic @moduledoc + @doc. standard: + examples. comprehensive: + AI metadata (Mermaid, YAML)"
    },
    {
      "name": "error_tracking_integration",
      "type": "choice",
      "prompt": "Error tracking integration for production monitoring?",
      "choices": [
        "none",
        "sentry",
        "custom"
      ],
      "default": "none",
      "hint": "Sentry integration for automatic error tracking and alerting in production"
    },
    {
      "name": "otp_release_ready",
      "type": "boolean",
      "prompt": "Target OTP release (production deployment)?",
      "default": true,
      "hint": "Ensures compatibility with hot code reloading, distributed tracing, release packaging"
    },
    {
      "name": "performance_critical",
      "type": "boolean",
      "prompt": "Is this performance-critical code?",
      "default": false,
      "hint": "Triggers: tail recursion requirements, stream usage, benchmarking, latency documentation"
    },
    {
      "name": "multi_tenancy",
      "type": "boolean",
      "prompt": "Multi-tenant environment?",
      "default": false,
      "hint": "Triggers: isolation checks, tenant-specific caching, audit logging, data separation"
    },
    {
      "name": "backward_compatibility",
      "type": "boolean",
      "prompt": "Must maintain backward compatibility?",
      "default": true,
      "hint": "Triggers: deprecation warnings, migration guides, version matrix documentation"
    }
  ],
  "prompts": {
    "code_generation": "Generate PRODUCTION-QUALITY Elixir code for: {task}\n\nREQUIREMENTS:\n- @moduledoc (100+ chars) with overview, examples, usage patterns\n- @doc for ALL public functions (50+ chars) with examples and edge cases\n- IMPORTANT: Use regular comments (# ...) for private functions, NOT @doc (causes warnings)\n- @typedoc for public types\n- @spec for ALL public functions, callbacks, and struct fields\n- Dialyzer-compatible types (strict mode)\n- Tagged tuple error handling {:ok, result} | {:error, reason}\n- NO raise in public API\n- with statements for error chains with else clause\n- Telemetry events for operations, errors, metrics\n- Logger with structured logging\n- Pattern matching required\n- Pipe operators for chains (2+ steps)\n- Tail recursion for recursive functions\n- Streams for large data\n- 85%+ test coverage target\n- Doctests for all public functions\n- RAG-optimized: semantic chunks, metadata tags, AI hints in moduledoc\n\nOUTPUT CODE ONLY.",
    "documentation": "Generate PRODUCTION-GRADE documentation for this Elixir code:\n\n```elixir\n{code}\n```\n\nINCLUDE @moduledoc with HUMAN CONTENT FIRST, then AI metadata:\n\n1. HUMAN CONTENT (top ~80 lines):\n   - Title: # ModuleName - Brief description\n   - Purpose: **What this module does** (bold, clear)\n   - Quick Start: Copy-paste examples showing common usage\n   - Public API: Bullet list of main functions\n   - Key Features: What makes this module valuable\n   - Complexity/Decision Guide: When to use what (if applicable)\n   - Error Handling: Common errors and solutions\n   - Examples: Real usage patterns with expected output\n\n2. SEPARATOR:\n   ---\n   ## AI Navigation Metadata\n   Brief explanation: \"The sections below provide structured metadata for AI assistants...\"\n\n3. AI METADATA (below separator):\n   - Module Identity (JSON): module, purpose, role, layer, alternatives, disambiguation\n   - Architecture Diagram (Mermaid): graph/sequence showing call flow\n   - Decision Tree (Mermaid): when/how to use different functions (if complex)\n   - Call Graph (YAML): calls_out, called_by, depends_on, supervision\n   - Data Flow (Mermaid sequence): if orchestrating components\n   - Anti-Patterns: what NOT to create, what NOT to call directly\n   - Search Keywords: 10+ keywords for vector search\n\nALSO INCLUDE:\n- @doc: Description, parameters, return values, examples, edge cases, errors\n- @typedoc: Type descriptions\n- Doctests for all public functions\n\nKEY: Human content at TOP (fast scanning), AI metadata BELOW (clear separation).\n\nOUTPUT DOCUMENTATION ONLY.",
    "tests": "Generate COMPREHENSIVE ExUnit tests for this code:\n\n```elixir\n{code}\n```\n\nINCLUDE:\n- Unit tests (all public functions)\n- Integration tests\n- Property tests (StreamData)\n- Edge cases\n- Error conditions\n- Concurrency tests (if applicable)\n- Async tests where possible\n- Target 85%+ coverage\n\nOUTPUT TEST MODULE ONLY."
  },
  "scoring_weights": {
    "has_moduledoc": 1.0,
    "has_function_docs": 1.0,
    "has_typedocs": 0.9,
    "has_type_specs": 1.0,
    "has_dialyzer": 0.9,
    "has_tests": 1.0,
    "test_coverage": 0.95,
    "has_doctests": 0.9,
    "error_handling": 1.0,
    "no_raise_in_public": 0.95,
    "has_telemetry": 0.85,
    "has_logging": 0.8,
    "no_code_smells": 1.0,
    "has_formatter_config": 0.7,
    "has_credo": 0.8,
    "uses_pattern_matching": 0.9,
    "uses_pipes": 0.7,
    "tail_recursive": 0.85,
    "rag_metadata": 0.9,
    "has_module_identity_json": 0.95,
    "has_architecture_diagram": 0.9,
    "has_call_graph_yaml": 0.9,
    "has_anti_patterns": 0.85,
    "has_search_keywords": 0.8,
    "human_content_first": 0.9,
    "clear_separation": 0.85,
    "ai_metadata_explained": 0.8,
    "graph_db_ready": 0.9,
    "vector_db_optimized": 0.9,
    "has_performance_characteristics": 0.9,
    "has_concurrency_safety_docs": 0.85,
    "has_degradation_patterns": 0.8,
    "has_version_compatibility": 0.85,
    "has_configuration_guide": 0.8,
    "has_observable_metrics": 0.9,
    "has_troubleshooting_guide": 0.75,
    "has_architecture_decisions": 0.7,
    "production_deployment_ready": 0.95,
    "security_reviewed": 0.95
  },
  "parent_pattern": null
}