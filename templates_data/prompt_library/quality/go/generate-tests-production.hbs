Generate COMPREHENSIVE Go tests for this code.

Code:
```go
{{code}}
```

INCLUDE:
- Unit tests (all exported functions)
- Table-driven tests for multiple scenarios
- Edge cases (nil, empty, boundary conditions)
- Error conditions (all error paths)
- Benchmark tests (for performance-critical code)
- Target 85%+ coverage

OUTPUT TEST FILE ONLY:
