# Singularity Environment Configuration
# Copy to .env and fill in your values

# =============================================================================
# AI Server Configuration
# =============================================================================

# Port for AI server (default: 3000)
PORT=3000

# AI Server URL (for Elixir to connect)
AI_SERVER_URL=http://localhost:3000

# Gemini Code Assist Project
GEMINI_CODE_PROJECT=gemini-code-473918
# (direnv defaults GEMINI_CODE_PROJECT, GOOGLE_CLOUD_PROJECT, and CLOUDSDK_CORE_PROJECT
# to gemini-code-473918 when unset. Override here if you use a different project.)

# =============================================================================
# Elixir/Phoenix Configuration
# =============================================================================

# Phoenix secret key base (generate with: mix phx.gen.secret)
SECRET_KEY_BASE=your_secret_key_base_here

# Phoenix host
PHX_HOST=localhost

# Database URL
DATABASE_URL=ecto://postgres:postgres@localhost/singularity_dev

# =============================================================================
# Human-Agent Communication (Choose ONE)
# =============================================================================

# Option 1: Slack (Recommended - supports bot token OR webhook)
# Get token from: https://api.slack.com/apps → Your App → OAuth & Permissions
SLACK_TOKEN=xoxe-xoxp-your-extended-oauth-token-here
SLACK_DEFAULT_CHANNEL=#agent-notifications
CHAT_CHANNEL=slack

# Option 2: Slack Webhook (simpler but less features)
# Get webhook from: https://api.slack.com/apps → Your App → Incoming Webhooks
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/T00000000/B00000000/XXXX
# CHAT_CHANNEL=slack

# Option 3: Google Chat
# Get webhook from: Google Chat space → Apps & integrations → Add webhooks
# GOOGLE_CHAT_WEBHOOK_URL=https://chat.googleapis.com/v1/spaces/...
# CHAT_CHANNEL=google_chat

# Web URL for interactive buttons (change for production)
WEB_URL=http://localhost:4000

# =============================================================================
# AI Provider Credentials (Optional - use encrypted files OR env vars)
# =============================================================================

# Option 1: Use encrypted .age files (recommended)
# - Run: cd ai-server && ./scripts/setup-encryption.sh
# - Then: ./scripts/encrypt-credentials.sh
# - Encrypted files are safe to commit

# Option 2: Set credentials directly (NOT recommended for production)
# GOOGLE_APPLICATION_CREDENTIALS_JSON=<base64 encoded ADC JSON>
# (If you use direnv and have run `gcloud auth application-default login`, this
# will be exported automatically from ~/.config/gcloud/application_default_credentials.json.)
# GOOGLE_AI_STUDIO_API_KEY=AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX (for Jules/Gemini)
# JULES_API_KEY=<Jules API key when available>
# CLAUDE_ACCESS_TOKEN=sk-ant-oat01-xxxxx
# TOOL_RUNNER_URL=http://localhost:4000/api/tools/run
# TOOL_RUNNER_TOKEN=optional_secret
# CLAUDE_CODE_OAUTH_TOKEN=sk-ant-oat01-xxxxx
# CURSOR_AUTH_JSON=<base64 encoded cursor auth.json>
# GH_TOKEN=ghp_xxxxx (for GitHub Copilot and Models)

# =============================================================================
# Encryption Key (for .age files)
# =============================================================================

# AGE_SECRET_KEY is used to decrypt .age files
# Generate with: age-keygen
# This should match the key in fly.io secrets
# AGE_SECRET_KEY=AGE-SECRET-KEY-xxxxx

# =============================================================================
# Development Tools
# =============================================================================

# Enable debug logging
# DEBUG=true
# LOG_LEVEL=debug

# Disable telemetry in development
# TELEMETRY_ENABLED=false

# =============================================================================
# Local Development Setup Instructions
# =============================================================================

# 1. Copy this file:
#    cp .env.example .env

# 2. Authenticate with AI providers:
#    gcloud auth application-default login  # Gemini
#    claude setup-token                     # Claude
#    cursor-agent login                     # Cursor
#    gh auth login                          # Copilot

# 3. Either:
#    a) Use encrypted credentials (recommended):
#       cd ai-server
#       ./scripts/setup-encryption.sh
#       ./scripts/encrypt-credentials.sh
#       git add .credentials.encrypted/*.age
#
#    b) OR set env vars above (not recommended)

# 4. Generate Phoenix secret:
#    mix phx.gen.secret
#    # Add to SECRET_KEY_BASE above

# 5. Start services:
#    # Terminal 1: Elixir
#    mix phx.server
#
#    # Terminal 2: AI Server
#    cd ai-server && bun run dev
#
#    # OR run both with Nix:
#    nix build .#singularity-integrated
#    ./result/bin/start-singularity

# =============================================================================
# Testing
# =============================================================================

# Test AI Server health
# curl http://localhost:3000/health

# Test from Elixir
# iex -S mix
# iex> Singularity.AIProvider.health_check()
# iex> Singularity.AIProvider.chat("gemini-code", [%{role: "user", content: "Hello"}])
