[package]
name = "knowledge"
version = "0.1.0"
edition = "2021"
description = "Knowledge management engine - shared library for central service and local NIF"
license = "MIT"

[lib]
name = "knowledge_engine"
crate-type = ["cdylib", "rlib"]  # cdylib for NIF, rlib for central service

[dependencies]
anyhow = { workspace = true }
serde = { workspace = true, features = ["derive"] }
serde_json = { workspace = true }
tokio = { workspace = true, features = ["full"] }
tracing = { workspace = true }
once_cell = { workspace = true }
parking_lot = { workspace = true }

# Rustler (for NIF)
rustler = { version = "0.34", optional = true }

# NATS (for distribution)
async-nats = { version = "0.33", optional = true }

# Database (PostgreSQL)
sqlx = { workspace = true, optional = true }

[features]
default = []
nif = ["rustler"]                    # For local NIF
central = ["async-nats", "sqlx"]     # For central service
