name: Copilot Setup Steps
on: workflow_dispatch # Or whatever trigger Copilot uses
jobs:
  copilot-setup-steps:
    runs-on: ubuntu-latest
    
    # Configure a Postgres service, common for Phoenix apps
    services:
      db:
        image: postgres:16
        ports: ["5432:5432"]
        env:
          POSTGRES_PASSWORD: postgres
    
    steps:
      # Step: Setup Elixir and Erlang using the community action
      - name: Set up Elixir
        uses: erlef/setup-beam@v1
        with:
          otp-version: "28" # Example latest Erlang/OTP version
          elixir-version: "1" # Example latest Elixir version
      
      - name: Install Bun
        uses: oven-sh/setup-bun@v2
        with:
          bun-version: latest
    
      - name: Checkout code
        uses: actions/checkout@v4
        
      # Step: Cache and get dependencies to speed up the agent
      - name: Cache deps
        uses: actions/cache@v3
        with:
          path: deps
          key: ${{ runner.os }}-mix-${{ hashFiles('**/mix.lock') }}
          
      - name: Get dependencies
        run: mix deps.get
        run: bun install
        
      # You might also cache the compiled _build directory and run mix compile
